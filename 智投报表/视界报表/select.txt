select
       replace_video_index
      , url as video_url -- 视频链接
      , video_title    -- 视频标题
      , vendor_id
      , name as demand_name --  需求方 '需求方'     
      , name as creator_name -- 创作团队
      , order_id
      , order_name
      , if(director_name is null,'_',director_name) as director_name
      , if(writer_name is null,'_',writer_name) as writer_name
      , if(camerist_name is null,'_',camerist_name) as camerist_name
      , if(late_name is null,'_',late_name) as late_name
      , cost -- 消耗金额
from (
      select  replace_video_index
             , max(if(is_replace_video=0, b.url, null))  url
             , max(if(is_replace_video=0, b.cover_image_url, null)) cover_image_url
             , max(ev.name) vendor_id
             , max(if(is_replace_video=0, b.name, null))  video_title
             , max(e.name)  name
        	 , max(c.name)            order_name
        	 , max(c.id)              order_id
             , max(director.name)     director_name
             , max(writer.name)       writer_name
             , max(camerist.name)     camerist_name
          	 , max(late.name)             late_name
             , sum(cost) / 10000          cost
      from makepolo.material_report a
          join makepolo.material_market_video b on a.material_video_id = b.id
          join makepolo.material_market_order c on b.order_id = c.id
          join makepolo_common.account_user d on d.id = c.account_id
        	-- join makepolo_common.account_user vau on a.video_account_id = vau.id
          join makepolo_common.account_admin e on d.company_id = e.id  
         left join makepolo.creator_role director on director.id = a.director_id and director.id > 0
         left join makepolo.creator_role writer on writer.id = a.writer_id and writer.id > 0
         left join  makepolo.creator_role camerist on camerist.id = a.camerist_id and camerist.id > 0
         left join makepolo.creator_role late on late.id = a.late_producer_id and late.id > 0
         left join makepolo_common.vendor ev on ev.vendor_id=a.vendor_id
      where is_test_data = 0
         and c.owner_creator_id = 64 
         and a.vendor_id = 1
         and a.date >= '2021-04-07'
         and a.date <=  '2021-04-07'
      group by 1
 ) creative
order by cost desc